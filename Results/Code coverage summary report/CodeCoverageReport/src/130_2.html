<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\Programming\Projects\LlmUnitTestGenerationArtifacts\Glm45AirUnitTests\Sample2Tests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Dataset.Sample2;
using NSubstitute;

namespace Glm45AirUnitTests;

public class EmployeeServiceTests
{
    private readonly IEmployeeRepository _employeeRepositorySubstitute;
    private readonly EmployeeService _employeeService;

    public EmployeeServiceTests()
    {
        _employeeRepositorySubstitute = Substitute.For&lt;IEmployeeRepository&gt;();
        _employeeService = new EmployeeService(_employeeRepositorySubstitute);
    }

    [Fact]
    public async Task GetAsync_WhenEmployeeExists_ReturnsEmployeeModel()
    {
        // Arrange
        var id = 1;
        var expectedEntity = new EmployeeEntity
        {
            Id = id,
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1,
            Department = &quot;IT&quot;,
            Position = &quot;Developer&quot;
        };
        _employeeRepositorySubstitute.GetAsync(id).Returns(expectedEntity);

        // Act
        var result = await _employeeService.GetAsync(id);

        // Assert
        Assert.Equal(expectedEntity.Id, result.Id);
        Assert.Equal(expectedEntity.FirstName, result.FirstName);
        Assert.Equal(expectedEntity.LastName, result.LastName);
    }

    [Fact]
    public async Task GetAsync_WhenEmployeeDoesNotExist_ReturnsNull()
    {
        // Arrange
        var id = 1;
        _employeeRepositorySubstitute.GetAsync(id).Returns((EmployeeEntity?)null);

        // Act
        var result = await _employeeService.GetAsync(id);

        // Assert
        Assert.Null(result);
    }

    [Fact]
    public async Task ListAsync_WhenCalled_ReturnsListOfEmployeeModels()
    {
        // Arrange
        var expectedEntities = new List&lt;EmployeeEntity&gt;
        {
            new EmployeeEntity
            {
                Id = 1,
                FirstName = &quot;John&quot;,
                LastName = &quot;Doe&quot;,
                MiddleName = &quot;Middle&quot;,
                BirthDate = new DateTime(1980, 1, 1),
                HireDate = new DateTime(2010, 1, 1),
                Salary = 50000,
                DepartmentId = 1,
                PositionId = 1,
                Department = &quot;IT&quot;,
                Position = &quot;Developer&quot;
            },
            new EmployeeEntity
            {
                Id = 2,
                FirstName = &quot;Jane&quot;,
                LastName = &quot;Smith&quot;,
                MiddleName = &quot;Middle&quot;,
                BirthDate = new DateTime(1985, 1, 1),
                HireDate = new DateTime(2012, 1, 1),
                Salary = 60000,
                DepartmentId = 2,
                PositionId = 2,
                Department = &quot;HR&quot;,
                Position = &quot;Manager&quot;
            }
        };
        _employeeRepositorySubstitute.ListAsync().Returns(expectedEntities);

        // Act
        var result = await _employeeService.ListAsync();

        // Assert
        Assert.Equal(2, result.Count);
        Assert.Equal(expectedEntities[0].Id, result.First().Id);
        Assert.Equal(expectedEntities[1].Id, result.Last().Id);
    }

    [Fact]
    public async Task ListFilteredAsync_WithAllFilterParametersEmptyOrZero_ReturnsAllEmployees()
    {
        // Arrange
        var allEmployees = new List&lt;EmployeeEntity&gt;
        {
            new EmployeeEntity { Id = 1 },
            new EmployeeEntity { Id = 2 }
        };
        _employeeRepositorySubstitute.ListAsync().Returns(allEmployees);
        _employeeRepositorySubstitute.ListFilteredAsync(
            Arg.Any&lt;string&gt;(), Arg.Any&lt;string&gt;(), Arg.Any&lt;string&gt;(), Arg.Any&lt;decimal&gt;(), Arg.Any&lt;decimal&gt;(), Arg.Any&lt;int&gt;(), Arg.Any&lt;int&gt;())
            .Returns(new List&lt;EmployeeEntity&gt;());

        // Act
        var result = await _employeeService.ListFilteredAsync(
            string.Empty, string.Empty, string.Empty, 0, 0, 0, 0);

        // Assert
        await _employeeRepositorySubstitute.DidNotReceive().ListFilteredAsync(
            Arg.Any&lt;string&gt;(), Arg.Any&lt;string&gt;(), Arg.Any&lt;string&gt;(), Arg.Any&lt;decimal&gt;(), Arg.Any&lt;decimal&gt;(), Arg.Any&lt;int&gt;(), Arg.Any&lt;int&gt;());
        Assert.Equal(2, result.Count);
    }

    [Fact]
    public async Task ListFilteredAsync_WithValidFilters_ReturnsFilteredEmployees()
    {
        // Arrange
        var filteredEntities = new List&lt;EmployeeEntity&gt;
        {
            new EmployeeEntity { Id = 1, FirstName = &quot;John&quot;, DepartmentId = 1 }
        };
        _employeeRepositorySubstitute.ListFilteredAsync(&quot;John&quot;, null, null, 0, 0, 1, 0)
            .Returns(filteredEntities);

        // Act
        var result = await _employeeService.ListFilteredAsync(&quot;John&quot;, null, null, 0, 0, 1, 0);

        // Assert
        Assert.Single(result);
        Assert.Equal(1, result.First().Id);
    }

    [Theory]
    [InlineData(null)]
    [InlineData(&quot;&quot;)]
    [InlineData(&quot;   &quot;)]
    public async Task AddAsync_WithInvalidEmployeeModel_ThrowsArgumentNullException(string firstName)
    {
        // Arrange
        var employeeModel = new EmployeeModel { FirstName = firstName };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentNullException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(&quot;Invalid123!&quot;)]
    [InlineData(&quot;NameWithTooManyCharactersExceedingTheFiftyCharacterLimit&quot;)]
    [InlineData(&quot; &quot;)]
    public async Task AddAsync_WithInvalidFirstName_ThrowsArgumentException(string firstName)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = firstName,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(&quot;Invalid123!&quot;)]
    [InlineData(&quot;NameWithTooManyCharactersExceedingTheFiftyCharacterLimit&quot;)]
    [InlineData(&quot; &quot;)]
    public async Task AddAsync_WithInvalidLastName_ThrowsArgumentException(string lastName)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = lastName,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(&quot;Invalid123!&quot;)]
    [InlineData(&quot;NameWithTooManyCharactersExceedingTheFiftyCharacterLimit&quot;)]
    [InlineData(&quot; &quot;)]
    public async Task AddAsync_WithInvalidMiddleName_ThrowsArgumentException(string middleName)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = middleName,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(1949, 12, 31)]
    [InlineData(2010, 1, 1)]
    public async Task AddAsync_WithInvalidBirthDate_ThrowsArgumentException(int birthYear, int birthMonth, int birthDay)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(birthYear, birthMonth, birthDay),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(&quot;Invalid123!&quot;)]
    [InlineData(&quot;NameWithTooManyCharactersExceedingTheFiftyCharacterLimit&quot;)]
    public async Task AddAsync_WithInvalidCountry_ThrowsArgumentException(string country)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1,
            Country = country
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(&quot;Invalid123!&quot;)]
    [InlineData(&quot;NameWithTooManyCharactersExceedingTheFiftyCharacterLimit&quot;)]
    public async Task AddAsync_WithInvalidCity_ThrowsArgumentException(string city)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1,
            City = city
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Fact]
    public async Task AddAsync_WithAddressTooLong_ThrowsArgumentException()
    {
        // Arrange
        var longAddress = new string(&#39;A&#39;, 51);
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1,
            Address = longAddress
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(&quot;1234567890&quot;)]
    [InlineData(&quot;++1234567890&quot;)]
    [InlineData(&quot;+12&quot;)]
    [InlineData(&quot;++1234567890123&quot;)]
    public async Task AddAsync_WithInvalidPhone_ThrowsArgumentException(string phone)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1,
            Phone = phone
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(1980, 1, 1)]
    [InlineData(1960, 1, 1)]
    [InlineData(2010, 1, 1)]
    public async Task AddAsync_WithInvalidHireDate_ThrowsArgumentException(int birthYear, int birthMonth, int birthDay)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(birthYear, birthMonth, birthDay),
            HireDate = new DateTime(birthYear, birthMonth, birthDay).AddDays(-1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(0)]
    [InlineData(-1)]
    public async Task AddAsync_WithInvalidSalary_ThrowsArgumentException(decimal salary)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = salary,
            DepartmentId = 1,
            PositionId = 1
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(0)]
    [InlineData(-1)]
    public async Task AddAsync_WithInvalidDepartmentId_ThrowsArgumentException(int departmentId)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = departmentId,
            PositionId = 1
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Theory]
    [InlineData(0)]
    [InlineData(-1)]
    public async Task AddAsync_WithInvalidPositionId_ThrowsArgumentException(int positionId)
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = positionId
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.AddAsync(employeeModel));
    }

    [Fact]
    public async Task AddAsync_WithValidModel_ReturnsIdAndCallsRepository()
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1
        };
        var expectedId = 1;
        _employeeRepositorySubstitute.AddAsync(Arg.Any&lt;EmployeeEntity&gt;()).Returns(expectedId);

        // Act
        var result = await _employeeService.AddAsync(employeeModel);

        // Assert
        Assert.Equal(expectedId, result);
        await _employeeRepositorySubstitute.Received(1).AddAsync(Arg.Any&lt;EmployeeEntity&gt;());
    }

    [Fact]
    public async Task UpdateAsync_WithInvalidId_ThrowsArgumentException()
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            Id = 0,
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1
        };

        // Act &amp; Assert
        await Assert.ThrowsAsync&lt;ArgumentException&gt;(() =&gt; _employeeService.UpdateAsync(employeeModel));
    }

    [Fact]
    public async Task UpdateAsync_WithValidModel_ReturnsIdAndCallsRepository()
    {
        // Arrange
        var employeeModel = new EmployeeModel
        {
            Id = 1,
            FirstName = &quot;John&quot;,
            LastName = &quot;Doe&quot;,
            MiddleName = &quot;Middle&quot;,
            BirthDate = new DateTime(1980, 1, 1),
            HireDate = new DateTime(2010, 1, 1),
            Salary = 50000,
            DepartmentId = 1,
            PositionId = 1
        };
        var expectedId = 1;
        _employeeRepositorySubstitute.UpdateAsync(Arg.Any&lt;EmployeeEntity&gt;()).Returns(expectedId);

        // Act
        var result = await _employeeService.UpdateAsync(employeeModel);

        // Assert
        Assert.Equal(expectedId, result);
        await _employeeRepositorySubstitute.Received(1).UpdateAsync(Arg.Any&lt;EmployeeEntity&gt;());
    }

    [Fact]
    public async Task DeleteAsync_WhenCalled_CallsRepository()
    {
        // Arrange
        var id = 1;
        _employeeRepositorySubstitute.DeleteAsync(id).Returns(1);

        // Act
        var result = await _employeeService.DeleteAsync(id);

        // Assert
        Assert.Equal(1, result);
        await _employeeRepositorySubstitute.Received(1).DeleteAsync(id);
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[11,5,11,34,1],[12,5,12,6,1],[13,9,13,79,1],[14,9,14,79,1],[15,5,15,6,1],[19,5,19,6,1],[21,9,21,20,1],[22,9,35,11,1],[36,9,36,76,1],[39,9,39,58,1],[42,9,42,52,1],[43,9,43,66,1],[44,9,44,64,1],[45,5,45,6,1],[49,5,49,6,1],[51,9,51,20,1],[52,9,52,83,1],[55,9,55,58,1],[58,9,58,29,0],[59,5,59,6,0],[63,5,63,6,1],[65,9,95,11,1],[96,9,96,77,1],[99,9,99,57,1],[102,9,102,39,1],[103,9,103,65,1],[104,9,104,64,1],[105,5,105,6,1],[109,5,109,6,1],[111,9,115,11,1],[116,9,116,73,1],[117,9,119,50,1],[122,9,123,67,1],[126,9,127,142,1],[128,9,128,39,1],[129,5,129,6,1],[133,5,133,6,1],[135,9,138,11,1],[139,9,140,40,1],[143,9,143,95,1],[146,9,146,31,1],[147,9,147,44,1],[148,5,148,6,1],[155,5,155,6,1],[157,9,157,73,1],[160,9,160,63,1],[160,63,160,103,1],[160,103,160,105,1],[161,5,161,6,0],[168,5,168,6,1],[170,9,180,11,1],[183,9,183,59,1],[183,59,183,99,1],[183,99,183,101,1],[184,5,184,6,1],[191,5,191,6,1],[193,9,203,11,1],[206,9,206,59,1],[206,59,206,99,1],[206,99,206,101,1],[207,5,207,6,1],[214,5,214,6,1],[216,9,226,11,1],[229,9,229,59,1],[229,59,229,99,1],[229,99,229,101,1],[230,5,230,6,1],[236,5,236,6,1],[238,9,248,11,1],[251,9,251,59,1],[251,59,251,99,1],[251,99,251,101,1],[252,5,252,6,1],[258,5,258,6,1],[260,9,271,11,1],[274,9,274,59,1],[274,59,274,99,1],[274,99,274,101,1],[275,5,275,6,1],[281,5,281,6,1],[283,9,294,11,1],[297,9,297,59,1],[297,59,297,99,1],[297,99,297,101,1],[298,5,298,6,1],[302,5,302,6,1],[304,9,304,47,1],[305,9,316,11,1],[319,9,319,59,1],[319,59,319,99,1],[319,99,319,101,1],[320,5,320,6,1],[328,5,328,6,1],[330,9,341,11,1],[344,9,344,59,1],[344,59,344,99,1],[344,99,344,101,1],[345,5,345,6,1],[352,5,352,6,1],[354,9,364,11,1],[367,9,367,59,1],[367,59,367,99,1],[367,99,367,101,1],[368,5,368,6,1],[374,5,374,6,1],[376,9,386,11,1],[389,9,389,59,1],[389,59,389,99,1],[389,99,389,101,1],[390,5,390,6,1],[396,5,396,6,1],[398,9,408,11,1],[411,9,411,59,1],[411,59,411,99,1],[411,99,411,101,1],[412,5,412,6,1],[418,5,418,6,1],[420,9,430,11,1],[433,9,433,59,1],[433,59,433,99,1],[433,99,433,101,1],[434,5,434,6,1],[438,5,438,6,1],[440,9,450,11,1],[451,9,451,28,1],[452,9,452,95,1],[455,9,455,69,1],[458,9,458,42,1],[459,9,459,93,1],[460,5,460,6,1],[464,5,464,6,1],[466,9,477,11,1],[480,9,480,59,1],[480,59,480,102,1],[480,102,480,104,1],[481,5,481,6,1],[485,5,485,6,1],[487,9,498,11,1],[499,9,499,28,1],[500,9,500,98,1],[503,9,503,72,1],[506,9,506,42,1],[507,9,507,96,1],[508,5,508,6,1],[512,5,512,6,1],[514,9,514,20,1],[515,9,515,66,1],[518,9,518,61,1],[521,9,521,33,1],[522,9,522,73,1],[523,5,523,6,1]]);
    </script>
  </body>
</html>