<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\Programming\Projects\LlmUnitTestGenerationArtifacts\Qwen3Coder30BUnitTests\Sample6Tests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using AutoMapper;
using Dataset.Sample6;
using NSubstitute;

namespace Qwen3Coder30BUnitTests
{
    public class LotServiceTests
    {
        private readonly IUnitOfWork _databaseSubstitute;
        private readonly IMapper _mapperSubstitute;
        private readonly LotService _service;

        public LotServiceTests()
        {
            _databaseSubstitute = Substitute.For&lt;IUnitOfWork&gt;();
            _mapperSubstitute = Substitute.For&lt;IMapper&gt;();
            _service = new LotService(_databaseSubstitute, _mapperSubstitute);
        }

        [Fact]
        public void AddLot_NullLot_ThrowsInvalidLotException()
        {
            // Arrange
            LotDTO lot = null;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _service.AddLot(lot));
        }

        [Fact]
        public void AddLot_LotWithSoldTrue_ThrowsInvalidLotException()
        {
            // Arrange
            var lot = new LotDTO { Sold = true };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _service.AddLot(lot));
        }

        [Fact]
        public void AddLot_LotWithNameNull_ThrowsInvalidLotException()
        {
            // Arrange
            var lot = new LotDTO { Name = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _service.AddLot(lot));
        }

        [Fact]
        public void AddLot_LotWithOwnerNull_ThrowsInvalidLotException()
        {
            // Arrange
            var lot = new LotDTO { Owner = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _service.AddLot(lot));
        }

        [Fact]
        public void AddLot_LotWithCategoryNull_ThrowsInvalidLotException()
        {
            // Arrange
            var lot = new LotDTO { Category = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _service.AddLot(lot));
        }

        [Fact]
        public void AddLot_ValidLot_CallsAddAndCommit()
        {
            // Arrange
            var lot = new LotDTO
            {
                Name = &quot;Test&quot;,
                Owner = &quot;Owner&quot;,
                Category = &quot;Category&quot;
            };

            var lotEntity = new Lot();
            _mapperSubstitute.Map&lt;LotDTO, Lot&gt;(lot).Returns(lotEntity);

            // Act
            _service.AddLot(lot);

            // Assert
            _databaseSubstitute.Lots.Received(1).Add(lotEntity);
            _databaseSubstitute.Received(1).Commit();
        }

        [Fact]
        public void DeleteLot_InvalidId_ThrowsInvalidIdException()
        {
            // Arrange
            const int id = 0;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidIdException&gt;(() =&gt; _service.DeleteLot(id));
        }

        [Fact]
        public void DeleteLot_ValidId_CallsDeleteAndCommit()
        {
            // Arrange
            const int id = 1;

            // Act
            _service.DeleteLot(id);

            // Assert
            _databaseSubstitute.Auctions.Received(1).Delete(id);
            _databaseSubstitute.Lots.Received(1).Delete(id);
            _databaseSubstitute.Received(1).Commit();
        }

        [Fact]
        public void GetLot_InvalidId_ThrowsInvalidIdException()
        {
            // Arrange
            const int id = 0;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidIdException&gt;(() =&gt; _service.GetLot(id));
        }

        [Fact]
        public void GetLot_ValidIdWithoutExistingLot_ThrowsInvalidIdException()
        {
            // Arrange
            const int id = 1;
            _mapperSubstitute.Map&lt;Lot, LotDTO&gt;(null).Returns((LotDTO)null);

            // Act &amp; Assert
            Assert.Throws&lt;InvalidIdException&gt;(() =&gt; _service.GetLot(id));
        }

        [Fact]
        public void GetLot_ValidIdWithExistingLot_ReturnsMappedLot()
        {
            // Arrange
            const int id = 1;
            var lotEntity = new Lot();
            var lotDto = new LotDTO();
            _mapperSubstitute.Map&lt;Lot, LotDTO&gt;(lotEntity).Returns(lotDto);

            _databaseSubstitute.Lots.Get(id).Returns(lotEntity);

            // Act
            var result = _service.GetLot(id);

            // Assert
            Assert.Same(lotDto, result);
        }

        [Fact]
        public void GetLots_ReturnsMappedLots()
        {
            // Arrange
            var lots = new List&lt;Lot&gt; { new Lot(), new Lot() };
            var lotsDto = new List&lt;LotDTO&gt; { new LotDTO(), new LotDTO() };

            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotsDto);
            _databaseSubstitute.Lots.GetAll().Returns(lots);

            // Act
            var result = _service.GetLots();

            // Assert
            Assert.Same(lotsDto, result);
        }

        [Fact]
        public void GetLotsByCategory_NullCategory_ThrowsInvalidCategoryException()
        {
            // Arrange
            string category = null;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidCategoryException&gt;(() =&gt; _service.GetLotsByCategory(category));
        }

        [Fact]
        public void GetLotsByCategory_ValidCategory_ReturnsMappedLots()
        {
            // Arrange
            const string category = &quot;TestCategory&quot;;
            var lots = new List&lt;Lot&gt; { new Lot(), new Lot() };
            var lotsDto = new List&lt;LotDTO&gt; { new LotDTO(), new LotDTO() };

            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotsDto);
            _databaseSubstitute.Lots.GetLotsByCategory(category).Returns(lots);

            // Act
            var result = _service.GetLotsByCategory(category);

            // Assert
            Assert.Same(lotsDto, result);
        }

        [Fact]
        public void GetLotsByName_NullName_ThrowsInvalidNameException()
        {
            // Arrange
            string name = null;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidNameException&gt;(() =&gt; _service.GetLotsByName(name));
        }

        [Fact]
        public void GetLotsByName_ValidName_ReturnsMappedLots()
        {
            // Arrange
            const string name = &quot;TestName&quot;;
            var lots = new List&lt;Lot&gt; { new Lot(), new Lot() };
            var lotsDto = new List&lt;LotDTO&gt; { new LotDTO(), new LotDTO() };

            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotsDto);
            _databaseSubstitute.Lots.GetLotsByName(name).Returns(lots);

            // Act
            var result = _service.GetLotsByName(name);

            // Assert
            Assert.Same(lotsDto, result);
        }

        [Fact]
        public void GetSoldLots_ReturnsMappedSoldLots()
        {
            // Arrange
            var lots = new List&lt;Lot&gt; { new Lot(), new Lot() };
            var lotsDto = new List&lt;LotDTO&gt; { new LotDTO(), new LotDTO() };

            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotsDto);
            _databaseSubstitute.Lots.GetSoldLots().Returns(lots);

            // Act
            var result = _service.GetSoldLots();

            // Assert
            Assert.Same(lotsDto, result);
        }

        [Fact]
        public void GetNotSoldLots_ReturnsMappedNotSoldLots()
        {
            // Arrange
            var lots = new List&lt;Lot&gt; { new Lot(), new Lot() };
            var lotsDto = new List&lt;LotDTO&gt; { new LotDTO(), new LotDTO() };

            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotsDto);
            _databaseSubstitute.Lots.GetNotSoldLots().Returns(lots);

            // Act
            var result = _service.GetNotSoldLots();

            // Assert
            Assert.Same(lotsDto, result);
        }

        [Fact]
        public void UpdateLot_NullLotDto_ThrowsInvalidLotException()
        {
            // Arrange
            LotDTO lotDto = null;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _service.UpdateLot(lotDto));
        }

        [Fact]
        public void UpdateLot_LotDtoWithNameNull_ThrowsInvalidLotException()
        {
            // Arrange
            var lotDto = new LotDTO { Name = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _service.UpdateLot(lotDto));
        }

        [Fact]
        public void UpdateLot_LotDtoWithOwnerNull_ThrowsInvalidLotException()
        {
            // Arrange
            var lotDto = new LotDTO { Owner = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _service.UpdateLot(lotDto));
        }

        [Fact]
        public void UpdateLot_LotDtoWithCategoryNull_ThrowsInvalidLotException()
        {
            // Arrange
            var lotDto = new LotDTO { Category = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _service.UpdateLot(lotDto));
        }

        [Fact]
        public void UpdateLot_LotNotFound_ThrowsInvalidIdException()
        {
            // Arrange
            var lotDto = new LotDTO { ID = 1, Name = &quot;Test&quot;, Owner = &quot;Owner&quot;, Category = &quot;Category&quot; };
            _databaseSubstitute.Lots.Get(lotDto.ID).Returns((Lot)null);

            // Act &amp; Assert
            Assert.Throws&lt;InvalidIdException&gt;(() =&gt; _service.UpdateLot(lotDto));
        }

        [Fact]
        public void UpdateLot_ValidLotDto_CallsUpdateAndCommit()
        {
            // Arrange
            var lotDto = new LotDTO { ID = 1, Name = &quot;UpdatedName&quot;, Owner = &quot;UpdatedOwner&quot;, Category = &quot;UpdatedCategory&quot;, Sold = true, Details = &quot;Details&quot; };
            var lotEntity = new Lot { Name = &quot;OldName&quot;, Owner = &quot;OldOwner&quot;, Category = &quot;OldCategory&quot;, Sold = false, Details = &quot;OldDetails&quot; };

            _databaseSubstitute.Lots.Get(lotDto.ID).Returns(lotEntity);

            // Act
            _service.UpdateLot(lotDto);

            // Assert
            Assert.Equal(lotDto.Name, lotEntity.Name);
            Assert.Equal(lotDto.Owner, lotEntity.Owner);
            Assert.Equal(lotDto.Sold, lotEntity.Sold);
            Assert.Equal(lotDto.Category, lotEntity.Category);
            Assert.Equal(lotDto.Details, lotEntity.Details);
            _databaseSubstitute.Lots.Received(1).Update(lotEntity);
            _databaseSubstitute.Received(1).Commit();
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[13,9,13,33,1],[14,9,14,10,1],[15,13,15,65,1],[16,13,16,59,1],[17,13,17,79,1],[18,9,18,10,1],[22,9,22,10,1],[24,13,24,31,1],[27,13,27,54,1],[27,54,27,74,1],[27,74,27,76,1],[28,9,28,10,1],[32,9,32,10,1],[34,13,34,50,1],[37,13,37,54,1],[37,54,37,74,1],[37,74,37,76,1],[38,9,38,10,1],[42,9,42,10,1],[44,13,44,50,1],[47,13,47,54,1],[47,54,47,74,1],[47,74,47,76,1],[48,9,48,10,1],[52,9,52,10,1],[54,13,54,51,1],[57,13,57,54,1],[57,54,57,74,1],[57,74,57,76,1],[58,9,58,10,1],[62,9,62,10,1],[64,13,64,54,1],[67,13,67,54,1],[67,54,67,74,1],[67,74,67,76,1],[68,9,68,10,1],[72,9,72,10,1],[74,13,79,15,1],[81,13,81,39,1],[82,13,82,72,1],[85,13,85,34,1],[88,13,88,65,1],[89,13,89,54,1],[90,9,90,10,1],[94,9,94,10,1],[99,13,99,77,1],[100,9,100,10,1],[104,9,104,10,1],[109,13,109,36,1],[112,13,112,65,1],[113,13,113,61,1],[114,13,114,54,1],[115,9,115,10,1],[119,9,119,10,1],[124,13,124,74,1],[125,9,125,10,1],[129,9,129,10,1],[132,13,132,76,1],[135,13,135,74,1],[136,9,136,10,1],[140,9,140,10,1],[143,13,143,39,1],[144,13,144,39,1],[145,13,145,75,1],[147,13,147,65,1],[150,13,150,46,1],[153,13,153,41,1],[154,9,154,10,1],[158,9,158,10,1],[160,13,160,63,1],[161,13,161,75,1],[163,13,163,97,1],[164,13,164,61,1],[167,13,167,45,1],[170,13,170,42,1],[171,9,171,10,1],[175,9,175,10,1],[177,13,177,36,1],[180,13,180,59,1],[180,59,180,95,1],[180,95,180,97,1],[181,9,181,10,1],[185,9,185,10,1],[188,13,188,63,1],[189,13,189,75,1],[191,13,191,97,1],[192,13,192,80,1],[195,13,195,63,1],[198,13,198,42,1],[199,9,199,10,1],[203,9,203,10,1],[205,13,205,32,1],[208,13,208,55,1],[208,55,208,83,1],[208,83,208,85,1],[209,9,209,10,1],[213,9,213,10,1],[216,13,216,63,1],[217,13,217,75,1],[219,13,219,97,1],[220,13,220,72,1],[223,13,223,55,1],[226,13,226,42,1],[227,9,227,10,1],[231,9,231,10,1],[233,13,233,63,1],[234,13,234,75,1],[236,13,236,97,1],[237,13,237,66,1],[240,13,240,49,1],[243,13,243,42,1],[244,9,244,10,1],[248,9,248,10,1],[250,13,250,63,1],[251,13,251,75,1],[253,13,253,97,1],[254,13,254,69,1],[257,13,257,52,1],[260,13,260,42,1],[261,9,261,10,1],[265,9,265,10,1],[267,13,267,34,1],[270,13,270,54,1],[270,54,270,80,1],[270,80,270,82,1],[271,9,271,10,1],[275,9,275,10,1],[277,13,277,53,1],[280,13,280,54,1],[280,54,280,80,1],[280,80,280,82,1],[281,9,281,10,1],[285,9,285,10,1],[287,13,287,54,1],[290,13,290,54,1],[290,54,290,80,1],[290,80,290,82,1],[291,9,291,10,1],[295,9,295,10,1],[297,13,297,57,1],[300,13,300,54,1],[300,54,300,80,1],[300,80,300,82,1],[301,9,301,10,1],[305,9,305,10,1],[307,13,307,103,1],[308,13,308,72,1],[311,13,311,53,1],[311,53,311,79,1],[311,79,311,81,1],[312,9,312,10,1],[316,9,316,10,1],[318,13,318,158,1],[319,13,319,142,1],[321,13,321,72,1],[324,13,324,40,1],[327,13,327,55,1],[328,13,328,57,1],[329,13,329,55,1],[330,13,330,63,1],[331,13,331,61,1],[332,13,332,68,1],[333,13,333,54,1],[334,9,334,10,1]]);
    </script>
  </body>
</html>