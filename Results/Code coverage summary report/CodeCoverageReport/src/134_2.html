<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\Programming\Projects\LlmUnitTestGenerationArtifacts\Glm45AirUnitTests\Sample6Tests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using AutoMapper;
using Dataset.Sample6;
using NSubstitute;

namespace Glm45AirUnitTests;

public class LotServiceTests
{
    private readonly IUnitOfWork _unitOfWorkSubstitute;
    private readonly IMapper _mapperSubstitute;
    private readonly LotService _lotService;

    public LotServiceTests()
    {
        _unitOfWorkSubstitute = Substitute.For&lt;IUnitOfWork&gt;();
        _mapperSubstitute = Substitute.For&lt;IMapper&gt;();
        _lotService = new LotService(_unitOfWorkSubstitute, _mapperSubstitute);
    }

    public class AddLot : LotServiceTests
    {
        [Fact]
        public void GivenNullLot_ThrowsInvalidLotException()
        {
            // Arrange
            LotDTO lot = null;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _lotService.AddLot(lot));
        }

        [Fact]
        public void GivenLotWithSoldTrue_ThrowsInvalidLotException()
        {
            // Arrange
            var lot = new LotDTO { Sold = true };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _lotService.AddLot(lot));
        }

        [Fact]
        public void GivenLotWithNullName_ThrowsInvalidLotException()
        {
            // Arrange
            var lot = new LotDTO { Name = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _lotService.AddLot(lot));
        }

        [Fact]
        public void GivenLotWithNullOwner_ThrowsInvalidLotException()
        {
            // Arrange
            var lot = new LotDTO { Owner = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _lotService.AddLot(lot));
        }

        [Fact]
        public void GivenLotWithNullCategory_ThrowsInvalidLotException()
        {
            // Arrange
            var lot = new LotDTO { Category = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _lotService.AddLot(lot));
        }

        [Fact]
        public void GivenValidLot_AddsLotAndCommits()
        {
            // Arrange
            var lotDto = new LotDTO { Name = &quot;Test Lot&quot;, Owner = &quot;Test Owner&quot;, Category = &quot;Test Category&quot;, Sold = false };
            var mappedLot = new Lot();
            _mapperSubstitute.Map&lt;LotDTO, Lot&gt;(lotDto).Returns(mappedLot);

            // Act
            _lotService.AddLot(lotDto);

            // Assert
            _unitOfWorkSubstitute.Lots.Received(1).Add(mappedLot);
            _unitOfWorkSubstitute.Received(1).Commit();
            Assert.NotNull(lotDto.Auction);
        }
    }

    public class DeleteLot : LotServiceTests
    {
        [Fact]
        public void GivenInvalidId_ThrowsInvalidIdException()
        {
            // Arrange
            int id = 0;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidIdException&gt;(() =&gt; _lotService.DeleteLot(id));
        }

        [Fact]
        public void GivenValidId_DeletesLotAndAuctionAndCommits()
        {
            // Arrange
            int id = 1;

            // Act
            _lotService.DeleteLot(id);

            // Assert
            _unitOfWorkSubstitute.Auctions.Received(1).Delete(id);
            _unitOfWorkSubstitute.Lots.Received(1).Delete(id);
            _unitOfWorkSubstitute.Received(1).Commit();
        }
    }

    public class GetLot : LotServiceTests
    {
        [Fact]
        public void GivenInvalidId_ThrowsInvalidIdException()
        {
            // Arrange
            int id = 0;
            _unitOfWorkSubstitute.Lots.Get(id).Returns((Lot)null);

            // Act &amp; Assert
            Assert.Throws&lt;InvalidIdException&gt;(() =&gt; _lotService.GetLot(id));
        }

        [Fact]
        public void GivenValidId_WhenLotExists_ReturnsMappedLot()
        {
            // Arrange
            int id = 1;
            var lot = new Lot();
            var lotDto = new LotDTO();
            _unitOfWorkSubstitute.Lots.Get(id).Returns(lot);
            _mapperSubstitute.Map&lt;Lot, LotDTO&gt;(lot).Returns(lotDto);

            // Act
            var result = _lotService.GetLot(id);

            // Assert
            Assert.Equal(lotDto, result);
        }

        [Fact]
        public void GivenValidId_WhenLotDoesNotExist_ThrowsInvalidIdException()
        {
            // Arrange
            int id = 1;
            _unitOfWorkSubstitute.Lots.Get(id).Returns((Lot)null);

            // Act &amp; Assert
            Assert.Throws&lt;InvalidIdException&gt;(() =&gt; _lotService.GetLot(id));
        }
    }

    public class GetLots : LotServiceTests
    {
        [Fact]
        public void WhenCalled_ReturnsMappedLots()
        {
            // Arrange
            var lots = new List&lt;Lot&gt;().AsReadOnly();
            var lotDtos = new List&lt;LotDTO&gt;().AsReadOnly();
            _unitOfWorkSubstitute.Lots.GetAll().Returns(lots);
            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotDtos);

            // Act
            var result = _lotService.GetLots();

            // Assert
            Assert.Equal(lotDtos, result);
        }
    }

    public class GetLotsByCategory : LotServiceTests
    {
        [Fact]
        public void GivenNullCategory_ThrowsInvalidCategoryException()
        {
            // Arrange
            string category = null;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidCategoryException&gt;(() =&gt; _lotService.GetLotsByCategory(category));
        }

        [Fact]
        public void GivenValidCategory_ReturnsMappedLots()
        {
            // Arrange
            string category = &quot;Test Category&quot;;
            var lots = new List&lt;Lot&gt;().AsReadOnly();
            var lotDtos = new List&lt;LotDTO&gt;().AsReadOnly();
            _unitOfWorkSubstitute.Lots.GetLotsByCategory(category).Returns(lots);
            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotDtos);

            // Act
            var result = _lotService.GetLotsByCategory(category);

            // Assert
            Assert.Equal(lotDtos, result);
        }
    }

    public class GetLotsByName : LotServiceTests
    {
        [Fact]
        public void GivenNullName_ThrowsInvalidNameException()
        {
            // Arrange
            string name = null;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidNameException&gt;(() =&gt; _lotService.GetLotsByName(name));
        }

        [Fact]
        public void GivenValidName_ReturnsMappedLots()
        {
            // Arrange
            string name = &quot;Test Name&quot;;
            var lots = new List&lt;Lot&gt;().AsReadOnly();
            var lotDtos = new List&lt;LotDTO&gt;().AsReadOnly();
            _unitOfWorkSubstitute.Lots.GetLotsByName(name).Returns(lots);
            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotDtos);

            // Act
            var result = _lotService.GetLotsByName(name);

            // Assert
            Assert.Equal(lotDtos, result);
        }
    }

    public class GetNotSoldLots : LotServiceTests
    {
        [Fact]
        public void WhenCalled_ReturnsMappedLots()
        {
            // Arrange
            var lots = new List&lt;Lot&gt;().AsReadOnly();
            var lotDtos = new List&lt;LotDTO&gt;().AsReadOnly();
            _unitOfWorkSubstitute.Lots.GetNotSoldLots().Returns(lots);
            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotDtos);

            // Act
            var result = _lotService.GetNotSoldLots();

            // Assert
            Assert.Equal(lotDtos, result);
        }
    }

    public class GetSoldLots : LotServiceTests
    {
        [Fact]
        public void WhenCalled_ReturnsMappedLots()
        {
            // Arrange
            var lots = new List&lt;Lot&gt;().AsReadOnly();
            var lotDtos = new List&lt;LotDTO&gt;().AsReadOnly();
            _unitOfWorkSubstitute.Lots.GetSoldLots().Returns(lots);
            _mapperSubstitute.Map&lt;IEnumerable&lt;Lot&gt;, IEnumerable&lt;LotDTO&gt;&gt;(lots).Returns(lotDtos);

            // Act
            var result = _lotService.GetSoldLots();

            // Assert
            Assert.Equal(lotDtos, result);
        }
    }

    public class UpdateLot : LotServiceTests
    {
        [Fact]
        public void GivenNullLotDto_ThrowsInvalidLotException()
        {
            // Arrange
            LotDTO lotDto = null;

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _lotService.UpdateLot(lotDto));
        }

        [Fact]
        public void GivenLotDtoWithNullName_ThrowsInvalidLotException()
        {
            // Arrange
            var lotDto = new LotDTO { Name = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _lotService.UpdateLot(lotDto));
        }

        [Fact]
        public void GivenLotDtoWithNullOwner_ThrowsInvalidLotException()
        {
            // Arrange
            var lotDto = new LotDTO { Owner = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _lotService.UpdateLot(lotDto));
        }

        [Fact]
        public void GivenLotDtoWithNullCategory_ThrowsInvalidLotException()
        {
            // Arrange
            var lotDto = new LotDTO { Category = null };

            // Act &amp; Assert
            Assert.Throws&lt;InvalidLotException&gt;(() =&gt; _lotService.UpdateLot(lotDto));
        }

        [Fact]
        public void GivenLotDtoWithNonExistingId_ThrowsInvalidIdException()
        {
            // Arrange
            var lotDto = new LotDTO { ID = 1, Name = &quot;Test&quot;, Owner = &quot;Test Owner&quot;, Category = &quot;Test&quot; };
            _unitOfWorkSubstitute.Lots.Get(lotDto.ID).Returns((Lot)null);

            // Act &amp; Assert
            Assert.Throws&lt;InvalidIdException&gt;(() =&gt; _lotService.UpdateLot(lotDto));
        }

        [Fact]
        public void GivenValidLotDto_UpdatesLotAndCommits()
        {
            // Arrange
            var lotDto = new LotDTO { ID = 1, Name = &quot;Updated Name&quot;, Owner = &quot;Updated Owner&quot;, Category = &quot;Updated Category&quot;, Sold = true, Details = &quot;Updated Details&quot; };
            var existingLot = new Lot();
            _unitOfWorkSubstitute.Lots.Get(lotDto.ID).Returns(existingLot);

            // Act
            _lotService.UpdateLot(lotDto);

            // Assert
            Assert.Equal(lotDto.Name, existingLot.Name);
            Assert.Equal(lotDto.Owner, existingLot.Owner);
            Assert.Equal(lotDto.Sold, existingLot.Sold);
            Assert.Equal(lotDto.Category, existingLot.Category);
            Assert.Equal(lotDto.Details, existingLot.Details);
            _unitOfWorkSubstitute.Lots.Received(1).Update(existingLot);
            _unitOfWorkSubstitute.Received(1).Commit();
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[13,5,13,29,1],[14,5,14,6,1],[15,9,15,63,1],[16,9,16,55,1],[17,9,17,80,1],[18,5,18,6,1],[24,9,24,10,1],[26,13,26,31,1],[29,13,29,54,1],[29,54,29,77,1],[29,77,29,79,1],[30,9,30,10,1],[34,9,34,10,1],[36,13,36,50,1],[39,13,39,54,1],[39,54,39,77,1],[39,77,39,79,1],[40,9,40,10,1],[44,9,44,10,1],[46,13,46,50,1],[49,13,49,54,1],[49,54,49,77,1],[49,77,49,79,1],[50,9,50,10,1],[54,9,54,10,1],[56,13,56,51,1],[59,13,59,54,1],[59,54,59,77,1],[59,77,59,79,1],[60,9,60,10,1],[64,9,64,10,1],[66,13,66,54,1],[69,13,69,54,1],[69,54,69,77,1],[69,77,69,79,1],[70,9,70,10,1],[74,9,74,10,1],[76,13,76,123,1],[77,13,77,39,1],[78,13,78,75,1],[81,13,81,40,1],[84,13,84,67,1],[85,13,85,56,1],[86,13,86,44,1],[87,9,87,10,1],[94,9,94,10,1],[96,13,96,24,1],[99,13,99,53,1],[99,53,99,78,1],[99,78,99,80,1],[100,9,100,10,1],[104,9,104,10,1],[106,13,106,24,1],[109,13,109,39,1],[112,13,112,67,1],[113,13,113,63,1],[114,13,114,56,1],[115,9,115,10,1],[122,9,122,10,1],[124,13,124,24,1],[125,13,125,67,1],[128,13,128,53,1],[128,53,128,75,1],[128,75,128,77,1],[129,9,129,10,1],[133,9,133,10,1],[135,13,135,24,1],[136,13,136,33,1],[137,13,137,39,1],[138,13,138,61,1],[139,13,139,69,1],[142,13,142,49,1],[145,13,145,42,1],[146,9,146,10,1],[150,9,150,10,1],[152,13,152,24,1],[153,13,153,67,1],[156,13,156,53,1],[156,53,156,75,1],[156,75,156,77,1],[157,9,157,10,1],[164,9,164,10,1],[166,13,166,53,1],[167,13,167,59,1],[168,13,168,63,1],[169,13,169,97,1],[172,13,172,48,1],[175,13,175,43,1],[176,9,176,10,1],[183,9,183,10,1],[185,13,185,36,1],[188,13,188,59,1],[188,59,188,98,1],[188,98,188,100,1],[189,9,189,10,1],[193,9,193,10,1],[195,13,195,47,1],[196,13,196,53,1],[197,13,197,59,1],[198,13,198,82,1],[199,13,199,97,1],[202,13,202,66,1],[205,13,205,43,1],[206,9,206,10,1],[213,9,213,10,1],[215,13,215,32,1],[218,13,218,55,1],[218,55,218,86,1],[218,86,218,88,1],[219,9,219,10,1],[223,9,223,10,1],[225,13,225,39,1],[226,13,226,53,1],[227,13,227,59,1],[228,13,228,74,1],[229,13,229,97,1],[232,13,232,58,1],[235,13,235,43,1],[236,9,236,10,1],[243,9,243,10,1],[245,13,245,53,1],[246,13,246,59,1],[247,13,247,71,1],[248,13,248,97,1],[251,13,251,55,1],[254,13,254,43,1],[255,9,255,10,1],[262,9,262,10,1],[264,13,264,53,1],[265,13,265,59,1],[266,13,266,68,1],[267,13,267,97,1],[270,13,270,52,1],[273,13,273,43,1],[274,9,274,10,1],[281,9,281,10,1],[283,13,283,34,1],[286,13,286,54,1],[286,54,286,83,1],[286,83,286,85,1],[287,9,287,10,1],[291,9,291,10,1],[293,13,293,53,1],[296,13,296,54,1],[296,54,296,83,1],[296,83,296,85,1],[297,9,297,10,1],[301,9,301,10,1],[303,13,303,54,1],[306,13,306,54,1],[306,54,306,83,1],[306,83,306,85,1],[307,9,307,10,1],[311,9,311,10,1],[313,13,313,57,1],[316,13,316,54,1],[316,54,316,83,1],[316,83,316,85,1],[317,9,317,10,1],[321,9,321,10,1],[323,13,323,104,1],[324,13,324,74,1],[327,13,327,53,1],[327,53,327,82,1],[327,82,327,84,1],[328,9,328,10,1],[332,9,332,10,1],[334,13,334,169,1],[335,13,335,41,1],[336,13,336,76,1],[339,13,339,43,1],[342,13,342,57,1],[343,13,343,59,1],[344,13,344,57,1],[345,13,345,65,1],[346,13,346,63,1],[347,13,347,72,1],[348,13,348,56,1],[349,9,349,10,1]]);
    </script>
  </body>
</html>