<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\Programming\Projects\LlmUnitTestGenerationArtifacts\Gpt5MiniUnitTests\Sample1Tests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Dataset.Sample1;
using NSubstitute;

namespace Gpt5MiniUnitTests
{
    public class DepartmentServiceTests
    {
        [Fact]
        public async Task GetAsync_ExistingId_ReturnsMappedDepartmentModel()
        {
            // Arrange
            var repository = Substitute.For&lt;IDepartmentRepository&gt;();
            var entity = new DepartmentEntity
            {
                Id = 5,
                Name = &quot;HR&quot;,
                Description = &quot;Human Resources&quot;
            };
            repository.GetAsync(Arg.Is(5)).Returns(Task.FromResult(entity));
            var service = new DepartmentService(repository);

            // Act
            var result = await service.GetAsync(5);

            // Assert
            Assert.NotNull(result);
            Assert.Equal(entity.Id, result.Id);
            Assert.Equal(entity.Name, result.Name);
            Assert.Equal(entity.Description, result.Description);
        }

        [Fact]
        public async Task GetAsync_RepositoryReturnsNull_ThrowsNullReferenceException()
        {
            // Arrange
            var repository = Substitute.For&lt;IDepartmentRepository&gt;();
            repository.GetAsync(Arg.Any&lt;int&gt;()).Returns(Task.FromResult&lt;DepartmentEntity?&gt;(null));
            var service = new DepartmentService(repository);

            // Act &amp; Assert
            await Assert.ThrowsAsync&lt;NullReferenceException&gt;(async () =&gt; await service.GetAsync(1));
        }

        [Fact]
        public async Task ListAsync_WhenCalled_ReturnsMappedCollection()
        {
            // Arrange
            var repository = Substitute.For&lt;IDepartmentRepository&gt;();
            var entities = new List&lt;DepartmentEntity&gt;
            {
                new DepartmentEntity { Id = 1, Name = &quot;A&quot;, Description = &quot;Desc A&quot; },
                new DepartmentEntity { Id = 2, Name = &quot;B&quot;, Description = null }
            };
            repository.ListAsync().Returns(Task.FromResult&lt;ICollection&lt;DepartmentEntity&gt;&gt;(entities));
            var service = new DepartmentService(repository);

            // Act
            var result = await service.ListAsync();

            // Assert
            Assert.NotNull(result);
            Assert.Equal(2, result.Count);
            var list = result.ToList();
            Assert.Equal(entities[0].Id, list[0].Id);
            Assert.Equal(entities[0].Name, list[0].Name);
            Assert.Equal(entities[0].Description, list[0].Description);
            Assert.Equal(entities[1].Id, list[1].Id);
            Assert.Equal(entities[1].Name, list[1].Name);
            Assert.Equal(entities[1].Description, list[1].Description);
        }

        [Fact]
        public async Task ListAsync_RepositoryReturnsEmptyList_ReturnsEmptyList()
        {
            // Arrange
            var repository = Substitute.For&lt;IDepartmentRepository&gt;();
            repository.ListAsync().Returns(Task.FromResult&lt;ICollection&lt;DepartmentEntity&gt;&gt;(new List&lt;DepartmentEntity&gt;()));
            var service = new DepartmentService(repository);

            // Act
            var result = await service.ListAsync();

            // Assert
            Assert.NotNull(result);
            Assert.Empty(result);
        }

        [Fact]
        public async Task ListAsync_RepositoryReturnsListContainingNull_ThrowsNullReferenceException()
        {
            // Arrange
            var repository = Substitute.For&lt;IDepartmentRepository&gt;();
            var entities = new List&lt;DepartmentEntity?&gt; { new DepartmentEntity { Id = 1, Name = &quot;X&quot;, Description = &quot;d&quot; }, null! };
            repository.ListAsync().Returns(Task.FromResult&lt;ICollection&lt;DepartmentEntity&gt;&gt;(entities.Cast&lt;DepartmentEntity&gt;().ToList()));
            var service = new DepartmentService(repository);

            // Act &amp; Assert
            await Assert.ThrowsAsync&lt;NullReferenceException&gt;(async () =&gt; await service.ListAsync());
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[10,9,10,10,1],[12,13,12,70,1],[13,13,18,15,1],[19,13,19,77,1],[20,13,20,61,1],[23,13,23,52,1],[26,13,26,36,1],[27,13,27,48,1],[28,13,28,52,1],[29,13,29,66,1],[30,9,30,10,1],[34,9,34,10,1],[36,13,36,70,1],[37,13,37,99,1],[38,13,38,61,1],[41,13,41,74,1],[41,74,41,99,1],[41,99,41,101,1],[42,9,42,10,1],[46,9,46,10,1],[48,13,48,70,1],[49,13,53,15,1],[54,13,54,102,1],[55,13,55,61,1],[58,13,58,52,1],[61,13,61,36,1],[62,13,62,43,1],[63,13,63,40,1],[64,13,64,54,1],[65,13,65,58,1],[66,13,66,72,1],[67,13,67,54,1],[68,13,68,58,1],[69,13,69,72,1],[70,9,70,10,1],[74,9,74,10,1],[76,13,76,70,1],[77,13,77,122,1],[78,13,78,61,1],[81,13,81,52,1],[84,13,84,36,1],[85,13,85,34,1],[86,9,86,10,1],[90,9,90,10,1],[92,13,92,70,1],[93,13,93,130,1],[94,13,94,136,1],[95,13,95,61,1],[98,13,98,74,1],[98,74,98,99,1],[98,99,98,101,1],[99,9,99,10,1]]);
    </script>
  </body>
</html>