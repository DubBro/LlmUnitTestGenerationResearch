<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\Programming\Projects\LlmUnitTestGenerationArtifacts\Gemini3ProUnitTests\Sample8Tests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Dataset.Sample8;

namespace Gemini3ProUnitTests;

public class LuTests
{
    [Fact]
    public void Decompose_WhenMatrixIsNotSquare_ThrowsArgumentException()
    {
        // Arrange
        var lu = new Lu();
        var matrix = new double[,]
        {
            { 1, 2, 3 },
            { 4, 5, 6 }
        };

        // Act &amp; Assert
        var exception = Assert.Throws&lt;ArgumentException&gt;(() =&gt; lu.Decompose(matrix));
        Assert.Equal(&quot;Source matrix is not square shaped.&quot;, exception.Message);
    }

    [Fact]
    public void Decompose_WhenMatrixIsSquare_ReturnsCorrectLowerAndUpperMatrices()
    {
        // Arrange
        var lu = new Lu();
        var matrix = new double[,]
        {
            { 2.0, -1.0, -2.0 },
            { -4.0, 6.0, 3.0 },
            { -4.0, -2.0, 8.0 }
        };
        int pivot = 3;

        // Act
        var (l, u) = lu.Decompose(matrix);

        // Assert
        // Verify dimensions
        Assert.Equal(pivot, l.GetLength(0));
        Assert.Equal(pivot, l.GetLength(1));
        Assert.Equal(pivot, u.GetLength(0));
        Assert.Equal(pivot, u.GetLength(1));

        // Verify L is lower triangular with 1s on diagonal
        for (int i = 0; i &lt; pivot; i++)
        {
            for (int j = 0; j &lt; pivot; j++)
            {
                if (i == j)
                {
                    Assert.Equal(1.0, l[i, j]);
                }
                else if (j &gt; i)
                {
                    Assert.Equal(0.0, l[i, j]);
                }
            }
        }

        // Verify U is upper triangular
        for (int i = 0; i &lt; pivot; i++)
        {
            for (int j = 0; j &lt; i; j++)
            {
                Assert.Equal(0.0, u[i, j]);
            }
        }

        // Verify L * U equals original matrix
        for (int i = 0; i &lt; pivot; i++)
        {
            for (int j = 0; j &lt; pivot; j++)
            {
                double sum = 0;
                for (int k = 0; k &lt; pivot; k++)
                {
                    sum += l[i, k] * u[k, j];
                }
                Assert.Equal(matrix[i, j], sum, 8);
            }
        }
    }

    [Fact]
    public void Eliminate_WhenMatrixIsNotSquare_ThrowsArgumentException()
    {
        // Arrange
        var lu = new Lu();
        var matrix = new double[,]
        {
            { 1, 2, 3 },
            { 4, 5, 6 }
        };
        var coefficients = new double[] { 1, 2 };

        // Act &amp; Assert
        var exception = Assert.Throws&lt;ArgumentException&gt;(() =&gt; lu.Eliminate(matrix, coefficients));
        Assert.Equal(&quot;Matrix of equation coefficients is not square shaped.&quot;, exception.Message);
    }

    [Fact]
    public void Eliminate_WhenSystemIs1x1_ReturnsCorrectSolution()
    {
        // Arrange
        var lu = new Lu();
        // Equation: 4x = 8 =&gt; x = 2
        var matrix = new double[,] { { 4.0 } };
        var coefficients = new double[] { 8.0 };

        // Act
        var solution = lu.Eliminate(matrix, coefficients);

        // Assert
        Assert.NotNull(solution);
        Assert.Single(solution);
        Assert.Equal(2.0, solution[0], 8);
    }

    [Fact]
    public void Eliminate_WhenSystemIs2x2_ReturnsCorrectSolution()
    {
        // Arrange
        var lu = new Lu();
        // System:
        // 2x + y = 5
        // 3x - 2y = 4
        // Solution: x = 2, y = 1
        var matrix = new double[,]
        {
            { 2.0, 1.0 },
            { 3.0, -2.0 }
        };
        var coefficients = new double[] { 5.0, 4.0 };

        // Act
        var solution = lu.Eliminate(matrix, coefficients);

        // Assert
        Assert.Equal(2, solution.Length);
        Assert.Equal(2.0, solution[0], 8);
        Assert.Equal(1.0, solution[1], 8);
    }

    [Fact]
    public void Eliminate_WhenSystemIs3x3_ReturnsCorrectSolution()
    {
        // Arrange
        var lu = new Lu();
        // System:
        // x + y + z = 6
        // 2x + y - z = 1
        // 2x - y + z = 3
        // Solution: x = 1, y = 2, z = 3
        var matrix = new double[,]
        {
            { 1.0, 1.0, 1.0 },
            { 2.0, 1.0, -1.0 },
            { 2.0, -1.0, 1.0 }
        };
        var coefficients = new double[] { 6.0, 1.0, 3.0 };

        // Act
        var solution = lu.Eliminate(matrix, coefficients);

        // Assert
        Assert.Equal(3, solution.Length);
        Assert.Equal(1.0, solution[0], 8);
        Assert.Equal(2.0, solution[1], 8);
        Assert.Equal(3.0, solution[2], 8);
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[9,5,9,6,1],[11,9,11,27,1],[12,9,16,11,1],[19,9,19,64,1],[19,64,19,84,1],[19,84,19,86,1],[20,9,20,80,1],[21,5,21,6,1],[25,5,25,6,1],[27,9,27,27,1],[28,9,33,11,1],[34,9,34,23,1],[37,9,37,43,1],[41,9,41,45,1],[42,9,42,45,1],[43,9,43,45,1],[44,9,44,45,1],[47,14,47,23,1],[47,25,47,34,1],[47,36,47,39,1],[48,9,48,10,1],[49,18,49,27,1],[49,29,49,38,1],[49,40,49,43,1],[50,13,50,14,1],[51,17,51,28,1],[52,17,52,18,1],[53,21,53,48,1],[54,17,54,18,1],[55,22,55,32,1],[56,17,56,18,1],[57,21,57,48,1],[58,17,58,18,1],[59,13,59,14,1],[60,9,60,10,1],[63,14,63,23,1],[63,25,63,34,1],[63,36,63,39,1],[64,9,64,10,1],[65,18,65,27,1],[65,29,65,34,1],[65,36,65,39,1],[66,13,66,14,1],[67,17,67,44,1],[68,13,68,14,1],[69,9,69,10,1],[72,14,72,23,1],[72,25,72,34,1],[72,36,72,39,1],[73,9,73,10,1],[74,18,74,27,1],[74,29,74,38,1],[74,40,74,43,1],[75,13,75,14,1],[76,17,76,32,1],[77,22,77,31,1],[77,33,77,42,1],[77,44,77,47,1],[78,17,78,18,1],[79,21,79,46,1],[80,17,80,18,1],[81,17,81,52,1],[82,13,82,14,1],[83,9,83,10,1],[84,5,84,6,1],[88,5,88,6,1],[90,9,90,27,1],[91,9,95,11,1],[96,9,96,50,1],[99,9,99,64,1],[99,64,99,98,1],[99,98,99,100,1],[100,9,100,98,1],[101,5,101,6,1],[105,5,105,6,1],[107,9,107,27,1],[109,9,109,48,1],[110,9,110,49,1],[113,9,113,59,1],[116,9,116,34,1],[117,9,117,33,1],[118,9,118,43,1],[119,5,119,6,1],[123,5,123,6,1],[125,9,125,27,1],[130,9,134,11,1],[135,9,135,54,1],[138,9,138,59,1],[141,9,141,42,1],[142,9,142,43,1],[143,9,143,43,1],[144,5,144,6,1],[148,5,148,6,1],[150,9,150,27,1],[156,9,161,11,1],[162,9,162,59,1],[165,9,165,59,1],[168,9,168,42,1],[169,9,169,43,1],[170,9,170,43,1],[171,9,171,43,1],[172,5,172,6,1]]);
    </script>
  </body>
</html>